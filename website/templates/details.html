{% extends 'base.html' %}

{% block content %}
<div class="container-fluid mt-4">
    
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-12">
                <div class="card shadow-sm" style="background: linear-gradient(135deg, #007bff, #00b894);
                 margin-bottom: 20px; height: 70px;">
                    <div class="card-body">
                        <h3 class="mb-4 text-center text-white"><i class="bi bi-person-square"></i> {{cust_rec.first_name}} {{cust_rec.last_name}}</h3>
                    </div>
                </div>
            </div>
        </div>


   
        <div class="card shadow-sm mb-5">
            <div class="card-header d-flex align-items-center justify-content-between">
                
                <ul class="nav nav-pills card-header-pills justify-content-center" id="customerTabs" role="tablist">
                    <li class="nav-item me-3" role="presentation">
                        <a class="nav-link active" id="personal-info-tab" data-bs-toggle="pill" href="#personal-info" role="tab" aria-controls="personal-info" aria-selected="true">
                            <i class="bi bi-person-circle"></i> Personal Info
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="subscription-details-tab" data-bs-toggle="pill" href="#subscription-details" role="tab" aria-controls="subscription-details" aria-selected="false">
                            <i class="bi bi-credit-card"></i> Subscription Details
                        </a>
                    </li>
                </ul>

                <a href="{% url 'delete_record' cust_rec.id %}" class="btn btn-danger ms-auto rounded-3"><i class="bi bi-x-lg"></i></a>
        </div>
        

        <div class="card-body">
           
            <div class="tab-content mt-4">
                
                <div class="tab-pane fade show active" id="personal-info" role="tabpanel" aria-labelledby="personal-info-tab">
                    <div class="row">
                        
                        <div class="col-md-5 col-sm-12">
                            <dl class="row">
                                <dt class="col-sm-4"> ID:</dt>
                                <dd class="col-sm-8">{{ cust_rec.id }}</dd>

                                <dt class="col-sm-4"> Email:</dt>
                                <dd class="col-sm-8">{{ cust_rec.email }}</dd>

                                <dt class="col-sm-4">Phone:</dt>
                                <dd class="col-sm-8">{{ cust_rec.phone }}</dd>
                            </dl>
                        </div>

                        
                        <div class="col-md-2 text-center">
                            <div class="vr" style="height: 100%; border-right: 1px solid #dee2e6;"></div>
                        </div>

                        
                        <div class="col-md-5">
                            <dl class="row">
                                <dt class="col-sm-4">City :</dt>
                                <dd class="col-sm-8">{{ cust_rec.city }}</dd>

                                <dt class="col-sm-4">State:</dt>
                                <dd class="col-sm-8">{{ cust_rec.state }}</dd>

                                <dt class="col-sm-4">Zipcode:</dt>
                                <dd class="col-sm-8">{{ cust_rec.zipcode }}</dd>

                                <dt class="col-sm-4">Created At:</dt>
                                <dd class="col-sm-8">{{ cust_rec.created_at|date:"Y-m-d H:i" }}</dd>
                            </dl>
                        </div>
                    </div>
                </div>

               
                <div class="tab-pane fade " id="subscription-details" role="tabpanel" aria-labelledby="subscription-details-tab">
                    <div class="row">
                       
                        <div class="col-md-5">
                            <dl class="row">
                                <dt class="col-sm-4">Contract:</dt>
                                <dd class="col-sm-8">{{ cust_rec.contract }}</dd>

                                <dt class="col-sm-4">Tenure:</dt>
                                <dd class="col-sm-8">{{ cust_rec.tenure }} months</dd>

                                <dt class="col-sm-4" style="white-space: nowrap;">Paperless Billing:</dt>
                                <dd class="col-sm-8" style="white-space: nowrap;">{{ cust_rec.paperless_billing }}</dd>

                                <dt class="col-sm-4">Phone Service:</dt>
                                <dd class="col-sm-8">{{ cust_rec.phone_service }}</dd>

                                <dt class="col-sm-4">Multiple Lines:</dt>
                                <dd class="col-sm-8">{{ cust_rec.multiple_lines }}</dd>

                                <dt class="col-sm-4">Online Security:</dt>
                                <dd class="col-sm-8">{{ cust_rec.online_security }}</dd>

                                <dt class="col-sm-4">Tech Support:</dt>
                                <dd class="col-sm-8">{{ cust_rec.tech_support }}</dd>
                                
                            </dl>
                        </div>

                       
                        <div class="col-md-2 text-center">
                            <div class="vr" style="height: 100%; border-right: 1px solid #dee2e6;"></div>
                        </div>

                        
                        <div class="col-md-5">
                            <dl class="row">
                                <dt class="col-sm-4" style="white-space: nowrap;">Monthly Charges:</dt>
                                <dd class="col-sm-8" style="white-space: nowrap;">{{ cust_rec.monthly_charges }}</dd>

                                <dt class="col-sm-4">Total Charges:</dt>
                                <dd class="col-sm-8">{{ cust_rec.total_charges }}</dd>

                                <dt class="col-sm-4" style="white-space: nowrap;">Payment Method:</dt>
                                <dd class="col-sm-8" style="white-space: nowrap;">{{ cust_rec.payment_method }}</dd>

                                <dt class="col-sm-4">Internet Service:</dt>
                                <dd class="col-sm-8">{{ cust_rec.internet_service }}</dd>

                                <dt class="col-sm-4" style="white-space: nowrap;" >Device Protection:</dt>
                                <dd class="col-sm-8" style="white-space: nowrap;" >{{ cust_rec.device_protection }}</dd>

                                <dt class="col-sm-4" style="white-space: nowrap;">Streaming Movies:</dt>
                                <dd class="col-sm-8" style="white-space: nowrap;">{{ cust_rec.streaming_movies }}</dd>

                                <dt class="col-sm-4">Streaming TV:</dt>
                                <dd class="col-sm-8">{{ cust_rec.streaming_tv }}</dd>

                                
                            </dl>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>

        
        <div class="card-footer text-center">
            <a href="{% url "update_record" cust_rec.id %}" class="btn mx-2 back-btn text-white" 
            style="background-color:#3b82f6;">Update <i class="bi bi-pencil-square"></i></a>
            <a class="btn mx-2 back-btn text-white" style="background-color:#0d9488;" id="predict-btn" customer-id = {{ cust_rec.id }}>Get insights 
                <i class="bi bi-info-square-fill"></i></a>
                
           
        </div>
    </div>
    <div class="card my-4 shadow" style="border-radius: 10px;">
        <div class="card-header text-white" style="background: linear-gradient(135deg, #007bff, #00b894); border-top-left-radius: 10px; border-top-right-radius: 10px;">
            <h5 class="card-title mt-2" style="font-size: 1.3rem;">
                <i class="bi bi-info-square-fill me-2"></i> Insights
            </h5>
        </div>
        <div class="card-body p-4">
            <div id="prediction-result" class="mb-3"></div>
            <h6 class="card-subtitle mb-2 text-muted">Churn Risk</h6>
            <div class="progress" style="height: 30px; border-radius: 15px;">
                <div id="progress-bar" 
                    class="progress-bar progress-bar-striped bg-danger" 
                    role="progressbar" 
                    style="width: 0%;" 
                    aria-valuenow="0" 
                    aria-valuemin="0" 
                    aria-valuemax="100">
                </div>
            </div>
            <div class="mt-3 small text-muted">
                <a href="https://www.kaggle.com/datasets/blastchar/telco-customer-churn" data-bs-toggle="popover" class="popover-link"
                    data-bs-content="Telco customer churn dataset link">
                    <i class="bi bi-info-circle me-1"></i></a>
                    Based on telco customer dataset
            </div>
        </div>
    </div>
    
    </div>
</div>
</div>
{% endblock %}